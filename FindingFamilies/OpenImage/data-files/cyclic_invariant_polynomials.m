

inv_polynomials:=AssociativeArray();

for n in [2,3,4,5,8,9,16] do
    A:=Transpose(CompanionMatrix(CyclotomicPolynomial(n)));  
    A:=ChangeRing(A,Rationals());  
    

    d:=EulerPhi(n);
    R<[x]>:=PolynomialRing(Rationals(),d);
    if n eq 2 then
        S:=[ x[1]^2 ];
    elif n eq 3 then
        S:=[
            x[1]^2 + x[1]*x[2] + x[2]^2,
            x[1]^2*x[2] + x[1]*x[2]^2,
            x[1]^3 + 3*x[1]^2*x[2] - x[2]^3
        ];
    elif n eq 4 then
        S:=[
            x[1]^2 + x[2]^2,
            x[1]^2*x[2]^2,
            2*x[1]^3*x[2] - 2*x[1]*x[2]^3
        ];
    elif n eq 5 then
        S:=[
            x[1]^2 + x[1]*x[3] + 2*x[1]*x[4] - x[2]*x[3] + x[2]*x[4] + x[4]^2,
            x[1]*x[2] - x[1]*x[4] + x[2]^2 + 2*x[2]*x[3] + x[3]^2 + x[3]*x[4],
            x[1]^2*x[3] + 2*x[1]*x[2]*x[3] + x[1]*x[3]^2 + x[2]^2*x[3] + x[2]^2*x[4] + x[2]*x[3]^2 + 2*x[2]*x[3]*x[4] + x[2]*x[4]^2,
            x[1]^2*x[2] + x[1]^2*x[4] + x[1]*x[2]^2 + 2*x[1]*x[2]*x[4] + 2*x[1]*x[3]*x[4] + x[1]*x[4]^2 + x[3]^2*x[4] + x[3]*x[4]^2,
            x[1]^3 + 3*x[1]^2*x[2] + 2*x[1]^2*x[3] + 2*x[1]^2*x[4] + x[1]*x[2]^2 + 2*x[1]*x[2]*x[3] + 2*x[1]*x[2]*x[4] 
                + x[1]*x[3]^2 + 2*x[1]*x[3]*x[4] + x[2]^2*x[3] - x[2]*x[4]^2 + x[3]^2*x[4] -  x[3]*x[4]^2 - x[4]^3
        ];
    elif n eq 8 then
        S:=[
            x[1]^2 + x[2]^2 + x[3]^2 + x[4]^2,
            x[1]*x[2] - x[1]*x[4] + x[2]*x[3] + x[3]*x[4],
            x[1]^4 + x[2]^4 + x[3]^4 + x[4]^4,
            x[1]^2*x[3]^2 + x[2]^2*x[4]^2,
            x[1]^3*x[2] - x[1]*x[4]^3 + x[2]^3*x[3] + x[3]^3*x[4]
        ];
    elif n eq 9 then
        S:=[
            x[1]^2 + x[1]*x[4] + x[2]^2 + x[2]*x[5] + x[3]^2 + x[3]*x[6] + x[4]^2 + x[5]^2 + x[6]^2,
            x[1]*x[3] - x[1]*x[5] + x[2]*x[4] - x[2]*x[6] + x[3]*x[4] + x[3]*x[5] + x[4]*x[6],
            x[1]*x[2] - x[1]*x[6] + x[2]*x[3] + x[2]*x[4] + x[3]*x[4] + x[3]*x[5] + x[4]*x[5] + x[5]*x[6],
            x[1]^2*x[4] + x[1]*x[4]^2 + x[2]^2*x[5] + x[2]*x[5]^2 + x[3]^2*x[6] + x[3]*x[6]^2,
            x[1]^2*x[3] + x[1]^2*x[6] - x[1]*x[2]^2 + 2*x[1]*x[3]*x[4] + x[1]*x[5]^2 - x[2]*x[3]^2 + 2*x[2]*x[4]*x[5] + x[2]*x[6]^2 + 2*x[3]*x[5]*x[6] - x[4]^2*x[6] + x[4]*x[5]^2 + x[5]*x[6]^2,
            x[1]^3 + 3*x[1]^2*x[4] + x[2]^3 + 3*x[2]^2*x[5] + x[3]^3 + 3*x[3]^2*x[6] - x[4]^3 - x[5]^3 - x[6]^3,
            x[1]^2*x[2] + x[1]^2*x[5] + 2*x[1]*x[2]*x[4] - x[1]*x[3]^2 + x[1]*x[6]^2 + x[2]^2*x[3] + x[2]^2*x[6] + 2*x[2]*x[3]*x[5] + 2*x[3]*x[4]*x[6] - x[4]^2*x[5] + x[4]*x[6]^2 - x[5]^2*x[6]
        ];
    elif n eq 16 then
        S:=[
            -x[1]*x[2] + x[1]*x[8] - x[2]*x[3] - x[3]*x[4] - x[4]*x[5] - x[5]*x[6] - x[6]*x[7] - x[7]*x[8],
            x[1]^2 + x[2]^2 + x[3]^2 + x[4]^2 + x[5]^2 + x[6]^2 + x[7]^2 + x[8]^2,
            -x[1]*x[3] + x[1]*x[7] - x[2]*x[4] + x[2]*x[8] - x[3]*x[5] - x[4]*x[6] - x[5]*x[7] - x[6]*x[8],
            -x[1]*x[4] + x[1]*x[6] - x[2]*x[5] + x[2]*x[7] - x[3]*x[6] + x[3]*x[8] - x[4]*x[7] - x[5]*x[8],
            x[1]^3*x[2] - x[1]*x[8]^3 + x[2]^3*x[3] + x[3]^3*x[4] + x[4]^3*x[5] + x[5]^3*x[6] + x[6]^3*x[7] + x[7]^3*x[8],
            x[1]^4 + x[2]^4 + x[3]^4 + x[4]^4 + x[5]^4 + x[6]^4 + x[7]^4 + x[8]^4,
            -x[1]^3*x[5] + x[1]*x[5]^3 - x[2]^3*x[6] + x[2]*x[6]^3 - x[3]^3*x[7] + x[3]*x[7]^3 - x[4]^3*x[8] + x[4]*x[8]^3,
            x[1]^2*x[2]*x[8] - x[1]*x[2]^2*x[3] + x[1]*x[7]*x[8]^2 - x[2]*x[3]^2*x[4] - x[3]*x[4]^2*x[5] - x[4]*x[5]^2*x[6] - x[5]*x[6]^2*x[7] - x[6]*x[7]^2*x[8],
            x[1]*x[2]*x[4]*x[5] + x[1]*x[2]*x[6]*x[7] - x[1]*x[3]*x[4]*x[8] - x[1]*x[5]*x[6]*x[8] + x[2]*x[3]*x[5]*x[6] + x[2]*x[3]*x[7]*x[8] + x[3]*x[4]*x[6]*x[7] + x[4]*x[5]*x[7]*x[8]
        ];
    end if;
    inv_polynomials[n]:=<A,S>;

end for;


